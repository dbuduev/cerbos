---
condition:
  all:
    of:
#      - expr: |-
#          R.attr.?department.optMap(v, v == "marketing")
      - expr: |-
          R.attr.?department == optional.of("marketing")
      - expr: |-
          R.attr[?"department"] == optional.of("marketing")
      - expr: |-
          R.attr.?no_such_field != optional.of("marketing")
      - expr: |-
          R.attr.?no_such_field == optional.none()
      - expr: |-
          R.attr.?no_such_field.orValue(0) == 0
      - expr: |-
          !R.attr.?no_such_field.hasValue()
      - expr: |-
          "a,b,c,d".split(",")[?5] == optional.none()
      - expr: |-
          "a,b,c,d".split(",")[?5].orValue("x") == "x"
input: {
  "requestId": "test",
  "actions": ["*"],
  "principal": {
    "id": "john",
    "roles": ["employee"],
    "attr": {
      "department": "marketing"
    }
  },
  "resource": {
    "kind": "leave_request",
    "attr": {
      "department": "marketing",
      "numbers": {
        "f": 2.0,
        "i": 1
      }
    }
  }
}
want: true
